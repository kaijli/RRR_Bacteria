---
title: "Thesis Graphs"
author: "Kaitlyn Li"
date: "11/4/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(googlesheets4)
```

#
```{r}
url <- "https://docs.google.com/spreadsheets/d/1JN0UHSJSlPWP07gGkodhEuOzFkuukClbuDjI7rDcokc/edit?usp=sharing"
streaks <- read_sheet(ss = url,
                     sheet = "Streaks")
srl_dils <- read_sheet(ss = url,
                     sheet = "Serial_Dilutions")
nming_dils <- read_sheet(ss = url,
                     sheet = "Normalizing_Dilutions")
nmed_dils <- read_sheet(ss = url,
                     sheet = "Normalized_Dilutions")

```

```{r eval = F}
ggplot(streaks, aes(x = Time, y = Colonies, color = Strain)) +
  geom_jitter() +
  geom_smooth(se = F, method = lm)
  
ggplot(srl_dils, aes(x = Time, y = CFU_mL, color = Strain)) +
  geom_jitter() +
  geom_smooth(se = F, method = lm)
```
```{r eval = F}
uv_sum <- streaks %>%
  group_by(Strain, Time) %>%
  summarise(mean = mean(Colonies),
            median = median(Colonies),
            sd = sd(Colonies)
            )
uv_sum
```
```{r eval = F}
ggplot(uv_sum, aes(x = Time, y = median, color = Strain)) +
  geom_jitter() +
  geom_smooth(se = F, method = lm)
```
```{r streaks_end eval = F}
final_uvs <- streaks %>%
  filter(Strain == c("D. Rad", "1F1", "1F5", "DH5-alpha"))
ggplot(final_uvs, aes(x = Time, y = Colonies, color = Strain)) +
  geom_jitter() +
  geom_smooth(se = F, method = lm)
  
pcr_strains <- streaks %>%
  filter(Strain == c("1F1", "1F5", "1FH2", "CM1"))
ggplot(pcr_strains, aes(x = Time, y = Colonies, color = Strain)) +
  geom_jitter() +
  geom_smooth(se = F, method = lm)
  
  
```



```{r p_survival}
sixtys_uv <- srl_dils %>%
  filter(Time == 60) %>%
  group_by(Strain, Set) %>%
  summarise(CFU_60 = mean(CFU_mL))

zeros_uv <- srl_dils %>%
  filter(Time == 0) %>%
  group_by(Strain, Set) %>%
  summarise(CFU_0 = mean(CFU_mL))

sz_uv <- left_join(zeros_uv, sixtys_uv)

sz_uv <- sz_uv %>%
  mutate(p_survival = CFU_60/CFU_0)

ggplot(sz_uv, aes(x = Strain, y = log(p_survival), color = Strain)) +
  geom_boxplot() +
  labs(title = "Percent Survival of Strains in UV irradiation",
       y = "Log10 of Percent Survival")

```

```{r t_tests}
dh5a <- sz_uv %>%
  filter(Strain == 	"DH5-alpha")

drad <- sz_uv %>%
  filter(Strain == 	"D. Rad")

f5 <- sz_uv %>%
  filter(Strain == 	"1F5")

fh2 <- sz_uv %>%
  filter(Strain == 	"1FH2")

cm1 <- sz_uv %>%
  filter(Strain == 	"CM1")


t.test(x = sz_uv$CFU_0, y = sz_uv$CFU_60) #all strains
t.test(x = dh5a$CFU_0, y = dh5a$CFU_60) #dh5a
t.test(x = drad$CFU_0, y = drad$CFU_60) #drad
t.test(x = f5$CFU_0, y = f5$CFU_60) #f5
t.test(x = cm1$CFU_0, y = cm1$CFU_60) #cm1
t.test(x = fh2$CFU_0, y = fh2$CFU_60) #fh2
```


```{r}

```
```{r normalized}
sixtys_uv <- nmed_dils %>%
  filter(Time == 60) %>%
  group_by(Strain, Set) %>%
  summarise(CFU_60 = mean(CFU_mL))

zeros_uv <- nmed_dils %>%
  filter('Time' == 0) %>%
  group_by('Strain', 'Set') %>%
  summarise(CFU_0 = mean('CFU_mL'))

sz_uv <- left_join(zeros_uv, sixtys_uv)

sz_uv <- sz_uv %>%
  mutate(p_survival = 'CFU_60'/'CFU_0')

ggplot(sz_uv, aes(x = 'Strain', y = log('p_survival'), color = 'Strain')) +
  geom_boxplot() +
  labs(title = "Percent Survival of Strains in UV irradiation",
       y = "Log10 of Percent Survival")

```